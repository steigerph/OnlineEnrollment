<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:ui="http://java.sun.com/jsf/facelets"
      xmlns:h="http://java.sun.com/jsf/html"
      xmlns:p="http://primefaces.org/ui">

    <h:head>
        <title>College Enrollment System</title>
        <meta name="viewport" content="width=device-width, initial-scale=1"/>

        <!-- Bootstrap CDN -->
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"/>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"/>

        <style>
            body {
                margin: 0;
                font-family: 'Segoe UI', sans-serif;
                background-color: #f4f6f9;
            }

            .layout-wrapper {
                display: grid;
                grid-template-areas: 
                    "header header"
                    "sidebar content"
                    "footer footer";
                grid-template-columns: 240px 1fr;
                grid-template-rows: 60px auto 50px;
                height: 100vh;
            }

            .header {
                grid-area: header;
                background-color: #3f51b5;
                color: white;
                padding: 15px 20px;
                display: flex;
                align-items: center;
                justify-content: space-between;
                box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
            }

            .header h2 {
                margin: 0;
                font-size: 1.5rem;
            }

            .sidebar {
                grid-area: sidebar;
                background-color: #2c387e;
                color: white;
                padding: 10px;
                overflow-y: auto;
                border-right: 1px solid #1a237e;
            }

            .sidebar .ui-menu {
                border: none;
                background: transparent;
            }

            .sidebar .ui-menu .ui-menuitem-link {
                color: #fff;
                padding: 10px 15px;
                display: block;
                border-radius: 5px;
            }

            .sidebar .ui-menu .ui-menuitem-link:hover {
                background-color: #00bcd4;
                color: #000;
            }

            .content {
                grid-area: content;
                padding: 25px;
                background-color: #fff;
                overflow-y: auto;
                border-left: 1px solid #ccc;
            }

            .footer {
                grid-area: footer;
                background-color: #3f51b5;
                color: white;
                text-align: center;
                padding: 10px;
                font-size: 0.9rem;
            }

            @media (max-width: 768px) {
                .layout-wrapper {
                    grid-template-areas: 
                        "header"
                        "content"
                        "footer";
                    grid-template-columns: 1fr;
                    grid-template-rows: 60px auto 50px;
                }

                .sidebar {
                    display: none;
                }
            }
        </style>

    </h:head>

    <h:body>

        <script>
            function togglePassword(fieldId, btn) {
                var field = document.getElementById(fieldId);
                var icon = btn.querySelector("i");
                if (field.type === "password") {
                    field.type = "text";
                    icon.classList.remove("fa-eye-slash");
                    icon.classList.add("fa-eye");
                } else {
                    field.type = "password";
                    icon.classList.remove("fa-eye");
                    icon.classList.add("fa-eye-slash");
                }
            }
        </script>

        <div class="layout-wrapper">

            <!-- HEADER -->
            <div class="header d-flex align-items-center">
                <h:graphicImage library="logo" name="logo.png"
                                style="height: 40px; margin-right: 15px;" alt="Logo" />

                <div class="d-flex flex-column flex-md-row align-items-center justify-content-between w-100">
                    <h2 class="mb-0 me-2">
                        <h:outputText value="Alitagtag College, Inc" /> -
                        <h:outputText value="College Enrollment System" />
                    </h2>

                </div>

                <div class="d-flex align-items-center justify-content-end" style="margin-left: auto; padding-left: 20px; gap: 15px;">

                    <div class="text-white" style="text-align: right;">
                        
                        <strong><h:outputText value="Welcome, #{loginBean.fullname}" /></strong>
                        <span style="margin: 0 15px;">
                        <em><h:outputText value="#{loginBean.userRole}" /></em>
                        </span>
                    </div>

                    <h:form>
                        <p:commandLink value="Logout"
                                       action="#{loginBean.logout}"
                                       styleClass="p-button-danger p-button-sm"
                                       style="color:white;" />
                    </h:form>

                </div>


            </div>



            <!-- SIDEBAR -->
            <div class="sidebar">
                <h:form>
                    <p:menu model="#{navigationBean.menuModel}" styleClass="nav-menu" />
                </h:form>
                <ui:insert name="sidebar" />
                


            </div>

            <!-- MAIN CONTENT -->
            <div class="content">
                <ui:insert name="content" />
            </div>

            <!-- FOOTER -->
            <div class="footer">
                &copy; 2025 College Enrollment System | All Rights Reserved
            </div>
        </div>
        <!-- Account Settings Modal with Tabs -->
        <p:dialog id="accountSettingsDialog"
                  widgetVar="accountSettingsWidget"
                  header="Account Settings"
                  modal="true"
                  resizable="false"
                  draggable="false"
                  closable="true"
                  width="700"
                  onHide="resetAccountForm()">

            <h:form id="accountForm">

                <p:tabView>
                    <!-- Update Info Tab -->
                    <p:tab title="Update Info">
                        <h:inputHidden value="#{accountSettingsBean.userId}" />

                        <!-- Username -->
                        <div class="form-group mb-3">
                            <p:selectBooleanCheckbox value="#{accountSettingsBean.editUsername}" itemLabel="Username">
                                <p:ajax listener="#{accountSettingsBean.updateEditState}" update="@form" />
                            </p:selectBooleanCheckbox>
                            <p:inputText value="#{accountSettingsBean.username}" styleClass="form-control"
                                         disabled="#{not accountSettingsBean.editUsername}" />
                        </div>

                        <!-- First Name -->
                        <div class="form-group mb-3">
                            <p:selectBooleanCheckbox value="#{accountSettingsBean.editFirstName}" itemLabel="First Name">
                                <p:ajax listener="#{accountSettingsBean.updateEditState}" update="@form" />
                            </p:selectBooleanCheckbox>
                            <p:inputText value="#{accountSettingsBean.firstName}" styleClass="form-control"
                                         disabled="#{not accountSettingsBean.editFirstName}" />
                        </div>

                        <!-- Last Name -->
                        <div class="form-group mb-3">
                            <p:selectBooleanCheckbox value="#{accountSettingsBean.editLastName}" itemLabel="Last Name">
                                <p:ajax listener="#{accountSettingsBean.updateEditState}" update="@form" />
                            </p:selectBooleanCheckbox>
                            <p:inputText value="#{accountSettingsBean.lastName}" styleClass="form-control"
                                         disabled="#{not accountSettingsBean.editLastName}" />
                        </div>

                        <p:commandButton value="Save Info"
                                         action="#{accountSettingsBean.updateInfo}"
                                         update="@form"
                                         process="@form"
                                         disabled="#{not accountSettingsBean.hasEditSelection}"
                                         oncomplete="if (args.updateSuccess) PF('accountSettingsWidget').hide();" />
                    </p:tab>

                    <!-- Change Password Tab -->
                    <p:tab title="Change Password">

                        <!-- Current Password -->
                        <div class="form-group mb-3">
                            <p:outputLabel for="currentPass" value="Current Password" />
                            <div class="input-group">
                                <p:password id="currentPass" value="#{accountSettingsBean.currentPassword}" feedback="false"
                                            styleClass="form-control" />
                                <button class="btn btn-outline-secondary" type="button" onclick="togglePasswordVisibility('accountForm:currentPass', this)">
                                    <i class="fa fa-eye-slash"></i>
                                </button>
                            </div>
                        </div>

                        <!-- New Password -->
                        <div class="form-group mb-3">
                            <p:outputLabel for="newPass" value="New Password" />
                            <div class="input-group">
                                <p:password id="newPass" value="#{accountSettingsBean.newPassword}" feedback="false"
                                            styleClass="form-control" />
                                <button class="btn btn-outline-secondary" type="button" onclick="togglePasswordVisibility('accountForm:newPass', this)">
                                    <i class="fa fa-eye-slash"></i>
                                </button>
                            </div>
                        </div>

                        <!-- Confirm Password -->
                        <div class="form-group mb-3">
                            <p:outputLabel for="confirmPass" value="Confirm New Password" />
                            <div class="input-group">
                                <p:password id="confirmPass" value="#{accountSettingsBean.confirmPassword}" feedback="false"
                                            styleClass="form-control" />
                                <button class="btn btn-outline-secondary" type="button" onclick="togglePasswordVisibility('accountForm:confirmPass', this)">
                                    <i class="fa fa-eye-slash"></i>
                                </button>
                            </div>
                        </div>

                        <p:commandButton value="Change Password"
                                         action="#{accountSettingsBean.changePassword}"
                                         update="@form"
                                         styleClass="btn btn-danger" />
                    </p:tab>

                </p:tabView>

            </h:form>
        </p:dialog>


    </h:body>
</html>
