<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<!-- /common/user-profile-dialog.xhtml -->
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                xmlns:h="http://xmlns.jcp.org/jsf/html"
                xmlns:p="http://primefaces.org/ui"
                xmlns:f="http://xmlns.jcp.org/jsf/core"
                xmlns:ui="http://xmlns.jcp.org/jsf/facelets">

    <p:dialog header="User Profile"
              widgetVar="userProfileDialog"
              modal="true"
              closable="true"
              resizable="false"
              draggable="false"
              width="500">

        <h:form id="profileForm">
            <p:messages showDetail="true" />

            <!-- ✅ Update Info Section -->
            <p:fieldset legend="Update Profile">
                <h:panelGrid columns="2" cellpadding="5">
                    <h:outputLabel value="Username:" for="username" />
                    <p:inputText id="username" value="#{userProfileBean.currentUser.username}" required="true" />

                    <h:outputLabel value="First Name:" for="firstname" />
                    <p:inputText id="firstname" value="#{userProfileBean.currentUser.firstname}" />

                    <h:outputLabel value="Last Name:" for="lastname" />
                    <p:inputText id="lastname" value="#{userProfileBean.currentUser.lastname}" />
                </h:panelGrid>

                <p:commandButton value="Update Info"
                                 action="#{userProfileBean.updateProfile}"
                                 update="@form"
                                 icon="pi pi-save"
                                 styleClass="p-button-sm" />
            </p:fieldset>

            <p:spacer height="20"/>

            <!-- ✅ Change Password Section -->
            <p:fieldset legend="Change Password">
                <h:panelGrid columns="2" cellpadding="5">
                    <h:outputLabel value="Current Password:" />
                    <p:password value="#{userProfileBean.currentPassword}" feedback="false" />

                    <h:outputLabel value="New Password:" />
                    <p:password value="#{userProfileBean.newPassword}" feedback="false" />

                    <h:outputLabel value="Confirm Password:" />
                    <p:password value="#{userProfileBean.confirmPassword}" feedback="false" />
                </h:panelGrid>

                <p:commandButton value="Change Password"
                                 action="#{userProfileBean.changePassword}"
                                 update="@form"
                                 icon="pi pi-key"
                                 styleClass="p-button-sm p-button-secondary" />
            </p:fieldset>
        </h:form>
    </p:dialog>
</ui:composition>

