<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:p="http://primefaces.org/ui">

    <h:head>
        <title>Online Enrollment Portal</title>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet"/>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"/>

        <style>
            body {
                font-family: 'Segoe UI', sans-serif;
                background-color: #f8f9fa;
                margin: 0;
            }

            .navbar-custom {
                background-color: #6a1b9a;
            }

            .navbar-custom .navbar-brand, .navbar-custom .nav-link {
                color: white !important;
            }

            .module-card {
                transition: transform 0.25s ease, box-shadow 0.25s ease;
                border: none;
                color: #fff;
                text-align: center;
                height: 140px;
                display: flex;
                flex-direction: column;
                justify-content: center;
            }

            .module-card:hover {
                transform: translateY(-6px);
                box-shadow: 0 8px 18px rgba(0, 0, 0, 0.2);
            }

            .footer {
                background-color: #6a1b9a;
                color: white;
                text-align: center;
                padding: 1rem;
                margin-top: 2rem;
            }

            .carousel-container {
                max-width: 1200px;
                margin: 2rem auto;
            }

            .card-text {
                color: rgba(255,255,255,0.9);
            }

            /* Module Colors */
            .admission { background-color: #03A9F4; }
            .registrar { background-color: #1976D2; }
            .dean { background-color: #388E3C; }
            .cashier { background-color: #FFA000; }
            .student { background-color: #607D8B; }
            .admin { background-color: #E53935; }
        </style>
    </h:head>

    <h:body>

        <!-- NAVBAR -->
        <nav class="navbar navbar-expand-lg navbar-custom">
            <div class="container-fluid">
                <h:graphicImage library="logo" name="logo.png"
                                style="height: 40px; margin-right: 15px;" alt="Logo" />
                <a class="navbar-brand" href="#">Alitagtag College, Inc. - College Enrollment System</a>

                <div class="d-flex">
                    <h:panelGroup rendered="#{loginBean.loggedIn}">
                        <h:outputText value="Welcome, #{loginBean.user.firstname}" styleClass="text-white me-3" />
                        <h:form>
                            <p:commandButton value="Logout"
                                             action="#{loginBean.logout}"
                                             styleClass="btn btn-light btn-sm" />
                        </h:form>
                    </h:panelGroup>

                    <h:panelGroup rendered="#{not loginBean.loggedIn}">
                        <h:form>
                            <p:commandButton value="Login"
                                             onclick="PF('loginDialog').show(); return false;"
                                             styleClass="btn btn-light btn-sm" />
                        </h:form>
                    </h:panelGroup>
                </div>
            </div>
        </nav>

        <!-- CAROUSEL -->
        <div class="carousel-container">
            <h:form>
                <p:carousel value="#{carouselUploadBean.imageList}" var="img" circular="true"
                            autoPlayInterval="4000" numVisible="1" style="max-width: 100%;">
                    <p:graphicImage value="#{resource['images/' += img]}" style="width:100%; height:auto;" />
                </p:carousel>
            </h:form>
        </div>

        <!-- SYSTEM MODULES -->
        <div class="container text-center mt-4">
            <h2 class="mb-4">System Modules</h2>

            <div class="row g-4 justify-content-center">
                <ui:repeat value="#{loginBean.loggedIn ? moduleBean.getModulesByRole(loginBean.user.role) : moduleBean.moduleList}" var="module">
                    <div class="col-md-4">
                        <h:form>
                            <div class="card module-card #{module.colorClass}">
                                <h4>#{module.name}</h4>
                                <p class="card-text">#{module.description}</p>

                                <h:panelGroup rendered="#{loginBean.loggedIn}">
                                    <p:commandButton value="Go to #{module.name}" 
                                                     action="#{loginBean.redirectTo(module.page)}"
                                                     styleClass="btn btn-outline-light btn-sm mt-2" />
                                </h:panelGroup>

                                <h:panelGroup rendered="#{not loginBean.loggedIn}">
                                    <p:commandButton value="Go to #{module.name}"
                                                     onclick="PF('loginDialog').show(); return false;"
                                                     styleClass="btn btn-outline-light btn-sm mt-2" />
                                </h:panelGroup>
                            </div>
                        </h:form>
                    </div>
                </ui:repeat>
            </div>
        </div>

        <!-- FOOTER -->
        <div class="footer">
            <h:outputText value="Â© 2025 Online Enrollment System. All rights reserved." />
            <br/>
            <h:outputLink value="#" onclick="PF('privacyDialog').show(); return false;" style="color:#ffc107; text-decoration:underline;">
                View Data Privacy Notice
            </h:outputLink>
        </div>

        <!-- LOGIN DIALOG -->
        <p:dialog id="loginDialog" header="Login" widgetVar="loginDialog"
                  modal="true" resizable="false" closable="true" width="400">
            <h:form id="loginForm">
                <h:panelGrid columns="2" cellpadding="5">
                    <h:outputLabel for="username" value="Username:" />
                    <p:inputText id="username" value="#{loginBean.user.username}" required="true" />

                    <h:outputLabel for="password" value="Password:" />
                    <p:password id="password" value="#{loginBean.user.password}" feedback="false" required="true" />
                </h:panelGrid>

                <p:messages id="loginMessages" showDetail="true" closable="true" />

                <div style="margin-top:15px; text-align:center;">
                    <p:commandButton value="Login"
                                     action="#{loginBean.login}"
                                     update="@form loginMessages"
                                     styleClass="p-button-primary w-100" />
                </div>
            </h:form>
        </p:dialog>

        <!-- DATA PRIVACY NOTICE DIALOG -->
        <p:dialog id="privacyDialog" widgetVar="privacyDialog" header="Data Privacy Notice"
                  modal="true" closable="true" resizable="false" width="600" height="400">
            <h:form id="privacyForm">
                <p:scrollPanel style="height:280px;">
                    <p>
                        <strong>Data Privacy Statement</strong><br/>
                        This system collects and processes personal information solely for academic and administrative purposes
                        in accordance with the Data Privacy Act of 2012 (RA 10173). Your data will be treated with utmost
                        confidentiality and will only be accessed by authorized personnel.
                    </p>

                    <p>
                        By continuing to use this system, you consent to the collection, storage, and processing of your data
                        for official school transactions.
                    </p>
                </p:scrollPanel>

                <div style="text-align:center; margin-top:15px;">
                    <p:commandButton value="I Understand" onclick="PF('privacyDialog').hide();" styleClass="p-button-success" />
                </div>
            </h:form>
        </p:dialog>

    </h:body>
</html>
