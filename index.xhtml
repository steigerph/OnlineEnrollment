<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:p="http://primefaces.org/ui"
      xmlns:ui="http://xmlns.jcp.org/jsf/facelets"
      xmlns:f="http://xmlns.jcp.org/jsf/core">

    <h:head>
        <title>College Enrollment Portal</title>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
        <style>
            body {
                font-family: 'Segoe UI', sans-serif;
                background-color: #f8f9fa;
            }
            .navbar-custom {
                background-color: #6a1b9a;
            }
            .navbar-custom .navbar-brand, .navbar-custom .nav-link {
                color: white;
            }
            .module-card {
                transition: transform 0.3s ease, box-shadow 0.3s ease;
                border-radius: 12px;
                color: white;
                padding: 1.5rem;
                cursor: pointer;
            }
            .module-card:hover {
                transform: translateY(-6px);
                box-shadow: 0 10px 20px rgba(0, 0, 0, 0.15);
            }
            .footer {
                background-color: #6a1b9a;
                color: white;
                text-align: center;
                padding: 1rem;
                margin-top: 3rem;
            }
            .carousel-caption {
                background-color: rgba(0,0,0,0.4);
                border-radius: 8px;
            }
            .privacy-checkbox {
                margin-top: 1rem;
                font-size: 0.9rem;
            }
        </style>
    </h:head>

    <h:body>

        <!-- NAVBAR -->
        <nav class="navbar navbar-expand-lg navbar-custom">
            <div class="container-fluid">
                <h:graphicImage library="logo" name="logo.png"
                                style="height: 40px; margin-right: 15px;" alt="Logo" />
                <a class="navbar-brand" href="#">Alitagtag College, Inc. - College Enrollment System</a>
                <div class="d-flex">
                    <!-- Show welcome + logout if logged in -->
                    <h:panelGroup rendered="#{loginBean.loggedIn}">
                        <h:outputText value="Welcome, #{loginBean.user.firstname}" styleClass="text-white me-3" />
                        <h:form>
                            <p:commandButton value="Logout" action="#{loginBean.logout}" styleClass="btn btn-light btn-sm" />
                        </h:form>
                    </h:panelGroup>

                    <!-- Show login button if not logged in -->
                    <h:panelGroup rendered="#{not loginBean.loggedIn}">
                        <button type="button" class="btn btn-light btn-sm" data-bs-toggle="modal" data-bs-target="#loginModal">
                            Login
                        </button>
                    </h:panelGroup>
                </div>
            </div>
        </nav>

        <!-- CAROUSEL -->
        <h:form>
            <p:carousel value="#{carouselUploadBean.imageList}" var="img" circular="true" autoPlayInterval="4000"
                        numVisible="1" style="max-width: 1200px; margin: 20px auto;">
                <p:graphicImage value="#{resource['images/' += img]}" style="width:100%; height:auto;" />
            </p:carousel>
        </h:form>

        <!-- MODULE CARDS -->
        <div class="container mt-5">
            <h2 class="text-center mb-4">System Modules</h2>
            <div class="row g-4 justify-content-center">
                <ui:repeat value="#{loginBean.loggedIn ? moduleBean.getModulesByRole(loginBean.user.role) : moduleBean.moduleList}" var="module">
                    <div class="col-md-4">
                        <div class="module-card text-center"
                             style="background-color: #{module.color};"
                             onclick="PF('loginDialog').show();">
                            <div class="card-body">
                                <h3 class="card-title">#{module.name}</h3>
                                <p class="card-text">#{module.description}</p>
                                <p:commandButton value="Go to #{module.name}" 
                                                 icon="pi pi-arrow-right"
                                                 styleClass="btn btn-light btn-sm mt-2"
                                                 onclick="PF('loginDialog').show(); return false;" />
                            </div>
                        </div>
                    </div>
                </ui:repeat>
            </div>
        </div>

        <!-- LOGIN DIALOG -->
        <p:dialog header="Login" widgetVar="loginDialog" modal="true" closable="true" resizable="false" width="400">
            <h:form id="loginForm">
                <h:panelGrid columns="2" cellpadding="5">
                    <h:outputLabel for="username" value="Username:" />
                    <p:inputText id="username" value="#{loginBean.user.username}" required="true" />

                    <h:outputLabel for="password" value="Password:" />
                    <p:password id="password" value="#{loginBean.user.password}" feedback="false" required="true" />
                </h:panelGrid>

                <!-- Data Privacy Agreement -->
                <div class="privacy-checkbox">
                    <p:selectBooleanCheckbox id="agreePrivacy" value="#{loginBean.agreedToPrivacy}" required="true"
                                             requiredMessage="You must agree to the Data Privacy Policy to proceed." />
                    <h:outputLabel for="agreePrivacy" value="I have read and agree to the " />
                    <h:outputLink value="#" onclick="PF('privacyDialog').show(); return false;" style="color:#6a1b9a; text-decoration:underline;">
                        Data Privacy Policy
                    </h:outputLink>
                </div>

                <p:messages id="loginMessages" showDetail="true" closable="true" />
                <p:commandButton value="Login" action="#{loginBean.login}" update="@form loginMessages"
                                 styleClass="p-button-primary w-100 mt-2" />
            </h:form>
        </p:dialog>

        <!-- DATA PRIVACY NOTICE -->
        <p:dialog header="ðŸ“œ Data Privacy Notice" widgetVar="privacyDialog" modal="true" width="550" resizable="false">
            <h:panelGrid columns="1" cellpadding="5">
                <h:outputText value="In compliance with Republic Act No. 10173 (Data Privacy Act of 2012), this system collects and processes your personal data solely for academic and administrative purposes." style="white-space: pre-line;" />
                <h:outputText value="All information will be treated confidentially and used only by authorized personnel of Alitagtag College, Inc. By continuing, you agree to the processing of your data as outlined in this notice." style="white-space: pre-line;" />
            </h:panelGrid>
            <f:facet name="footer">
                <p:commandButton value="I Understand" onclick="PF('privacyDialog').hide();" styleClass="p-button-primary" />
            </f:facet>
        </p:dialog>

        <!-- FOOTER -->
        <div class="footer">
            <span>Â© 2025 College Enrollment System</span> |
            <a href="#" onclick="PF('privacyDialog').show(); return false;" style="color:#ffc107;">Data Privacy Notice</a>
        </div>

    </h:body>
</html>
